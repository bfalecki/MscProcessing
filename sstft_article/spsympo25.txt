Artykuł SPSympo


Arai, On the noninvasive microwave measurement of respiration and heartbeat
https://www-1jstage-1jst-1go-1jp-1000098lm0112.eczyt.bg.pw.edu.pl/article/jsmbe1963/15/Supplement2/15_Supplement2_466/_article/-char/ja/
@article{1977466,
  title={一般演題 その47},
  author={},
  journal={医用電子と生体工学},
  volume={15},
  number={Supplement2},
  pages={466-473},
  year={1977},
  doi={10.11239/jsmbe1963.15.Supplement2_466}
}
第16回日本ME学会大会
2a-E-1
マイクロ波による呼吸および心拍の無侵襲測定に関する 基礎的考察
Maikuroha ni yoru kokyū oyobi shinpaku no mu shinshū sokutei ni kansuru kiso-teki kōsatsu
Fundamental Considerations on Non-invasive Measurement of Respiration and Heart Rate Using Microwaves
○荒井郁男* 鈴木務* 高橋良**
*電気通信大学
**三栄測器 K.K.
呼吸と心拍の非侵襲的マイクロ波測定について
Ikuo ARAI* Tsutomu SUZUKI*, Ryo TAKAHASHI**
*電気通信大学、**三栄測器株式会社


James C lin
Noninvasive microwave measurement of respiration

wcześniejsze zastosowania mikrofal (ale chyba dotykowe)
https://ieeexplore.ieee.org/document/10322785

sub 1 ghz
https://ieeexplore.ieee.org/document/10221349

Do zrobienia
- Synchrosqueezing 1 i 2 rzędu porównanie
- dogenerowac obrazki do artykułu (sstft1, sstft2, sstft z liniami, maska, rekonstrukcja oddechu, tętna, surowy sygnał, stft, reassignment?, rms, fft z rms)
- Rms sygnału akcji serca i dopiero FFT
- sprawdzić, co się uzyskuje dla zwyklego stft
- przeczytać wstęp poprzedniego artykułu i tutaj napisać wszystko to, co chciałbym zrobić lepiej
 

section{Abstract}
%This paper focuses on radar measurement of vital signs using time-frequency analysis with vertical synchrosqueezing concentration to increase the resolution of the distribution. The signal is decomposed into breath and heartbeat components and their reconstruction is done by an inverse transform of the distribution with a binary mask applied. Finally, the heart rate is estimated using the spectral analysis of instantaneous signal strength.


This paper focuses on radar measurement of vital signs using time-frequency analysis with vertical synchrosqueezing concentration to increase the resolution of the distribution. To decompose the signal into breathing and heartbeat component, the vertical synchrosqueezing method was used. In the first step, the component related to respiration is extracted from the signal. Then, it is removed to obtain a waveform corresponding to the heart activity with reduced noise. Finally, the heart rate is estimated using the spectral analysis of instantaneous signal strength.



section{Introduction}

Microwave-assisted monitoring of vital signs is a concept that dates back to 1975 [] when J. Lin managed to measure human's and also rabbit's breath-related displacements.
Then, in 1977 [] I. Arai et al. published a work under a successful measurement of breath as well as heartbeat.

However, in recent years, this idea has been gaining more and more interest due to the non-contact measurement. Since then, countless publications have been published describing both hardware solutions and signal processing. Various types of radars are used for this purpose - very often FMCW, but also IR-UWB or CW in a wide range of carrier frequencies from single GHz [] to over 100 GHz [].

For processing, the signal phase demodulation is typically used, which is directly related to the displacement of the observed surface. For this purpose, there are advanced algorithms for decomposition and estimation of vital parameters such as empirical mode decomposition [] or even neural networks [].
 



Less popular than phase demodulation is the use of time-frequency analysis, perhaps due to its computational complexity. However, it is a powerful representation that can be successfully used in real-time applications [find].

Measuring human vital signs using radar is challenging because the only information used for estimation is the micro-Doppler signature related to the displacement of the chest due to breathing and heart activity.

The superposition of these two components forms a signal that has both a slowly varying component associated with respiration and cyclic, high-frequency heart-related oscillations.
 
To obtain a faithful representation of the Doppler frequency changes for this type of signal, high resolution of both time and frequency is necessary.





[WPROWADZENIE W TEMATYKE KONCENTRACJI]

Nevertheless, typical time-frequency methods have often unsatisfactory trade-off between time and frequency resolution [STFT] or are burdened with non-negligible interferences [WVD].

To increase the resolution of the TF-plane, some techniques can be used to shift the distribution points towards higher energy locations to concentrate the image.

The origin of time-frequency representation concentration techniques is almost as old as the concept of microwave measurement of vital signs.

A technique similar to nowadays called reassignment [] was first described in 1976 under the name of modified moving window method.
Since then, many different concentration techniques have been developed, and in some cases a thorough mathematical background has been formulated [Sync].

With this kind of approach, it is possible to significantly improve the resolution of the TF-distribution in one dimension while maintaining satisfactory resolution in the other dimension [sync] or to concentrate both dimensions simultaneously [reas].

The first method, in which points are moved in only one dimension is called synchrosqueezing and its use allows for fully recovering the original signal from the concentrated TF-plane.
Synchrosqueezing can be divided into the vertical type, where the points are moved only along the frequency axis, and the horizontal type, where the points are moved only along the time axis.

The second method, in which points can be moved in both axes simultaneously is an above-mentioned reassignment.
In this case, the original signal reconstruction is no longer possible from the processed TF-plane, but reassignment possibly allows for a better concentration than synchrosqueezing.




section{Vertical synchrosqueezing}

Here is a brief introduction to synchrosqueezing method which is used in this paper to decompose the vital signs radar signal. First, let's consider short time Fourier transform według następującej definicji []:
....

eq.1 z sync


To estimate the exact instantaneous frequency of a supposed signal component in the vicinity of a point (w,t) whose energy is spread out causing an increase in energy at that point, an instantaneous frequency estimator is introduced, which can be calculated from the formula []:
eq 7
It can be interpreted as the local center of gravity for energy in the frequency axis.
Fourier synchrosqueezing transform is then obtained by redistribution of each STFT point to the estimated w^(t,w) frequency według następującej reguły[]
eq 10
(Równanie z deltą)
where delta is the Dirac delta function.
Therefore, the individual distribution points are moved only along the frequency axis, which allows for the full reconstruction of the original signal similarly to the case of the ordinary STFT. The inverse transform is done by simply summing the distribution points along the frequency axis, which is expressed by the equation:
eq 9
The distribution can be previously multiplied by a binary mask to extract a particular signal component.
 
Cześć, zrobiłem wstępną wersję artykułu na SPSympo. Niektóre rozdziały mogą być zrobione trochę na szybko, ale ogólnie wygląda chyba nieźle. Możesz rzucić okiem szczególnie na rozdział o synchrosqueezingu?
Poniżej link do overleafa
https://www.overleaf.com/2924675667nrzxpnmgzjnd#45c329

Skopiowałem wzory 1:1 z "Time-Frequency Reassignment and Synchrosqueezing: An overview", ale być może coś źle zinterpretowałem.
Wygenerowałem nowe wyniki z innego nagrania i wygląda to fajnie.
Użyłem tutaj tylko synchrosqueezingu 1. rzędu, bo nie chciałem już komplikować w opisie analitycznym, ale w wersji full paper może można to jeszcze uzupełnić.
Jest jeszcze taka kwestia, że na SPSympo przesyła się abstrakty do 4 stron, a tutaj jest nieco ponad, więc trzeba będzie nieco treści na razie skompresować.




section{Measurement setup}

Eksperymentalne nagranie radarowe czynności życiowych zostało uzyskane z wykorzystaniem FMCW XY-DemoRad radar \cite{demorad}.
Urządzenie transmituje falę o wysokiej częstotliwości 120 GHz z pasmem 13.5 GHz.
Human target był w nieruchomej sitting position with 30 cm chest-to-antenna distance.
Antena radaru była skierowana prosto na klatkę piersiową bez żadnych przeszkód.
Całość nagrania trwa 10 s przy pulse repetition frequency równym 5kHz.
Nagranie zostało zapisane na dysku twardym, a następnie post-przetwarzane w środowisku MATLAB.

- 
- FMCW DemoRad [] transmitting 122 GHz wave which allows for high sensitivity to micro-Doppler.
 
section{Processing}

most intense row in range-time map -> 
vertical synchrosqueezing transform-> 
IF-ridge detection -> 
binary mask generation ->
mask application & component reconstruction -> 
rms calculation & spectrum analysis


Schemat przetwarzania sygnału jest przedstawiony na Fig.~\ref{processing}.
Pierwszym etapem po wyborze odpowiedniej range cell z mapy range-time jest obliczenie Fourier synchrosqueezing transform drugiego rzędu.
Następnie detekowanych jest kilka najsilniejszych grzbietów czasowo-częstotliwościowych (Fig.~\ref{ridges}), które głównie naśladują komponent związany z oddychaniem. Konieczne jest wykrycie kilku grzbietów, bo metoda synchrosqueezingu często powoduje ich rozszczepienie, gdy energia sygnału jest zbyt szeroko rozprowadzona na. Na podstawie wykrytych grzbietów, w pewnym ich sąsiedztwie generowana jest połączona maska binarna (Fig.~\ref{mask}), która zawiera wolnozmienny komponent oddechowy na TF-plane.
Aby uzyskać komponent aktywności serca z filtered-out komponentem oddechowym, zastosowano negację maski.
Rekonstrukcja sygnału od poszczególnych komponentów jest uzyskana przez transformację odwrotną według ().
Po rekonstrukcji obliczana jest chwilowa moc sygnału od poszczególnych komponentów za pomocą windowed root mean square (RMS) envelope.
Finally, the spectrum analysis of the envelope is computed to estimate the breathing rate and heart rate.





To decompose the signal into breathing and heartbeat component, the vertical synchrosqueezing method was used.
In the first step, the component related to respiration is extracted from the signal. Then, it is removed to obtain a waveform corresponding to the heart activity with reduced noise.





section{Results}

The radar echo of measured vital signs is shown in Fig.~\ref{fig:raw}. Nagranie przedstawia dwa powolne cykle oddechowe. W sygnale widoczne są zmiany częstotliwości Dopplera związane z respiratory-related ruchem klatki piersiowej w przód i w tył.
Na pierwszy rzut oka nie widać żadnych wibracji związanych z pracą serca, jednak analiza czasowo-częstotliwościowa je ujawnia jako cykliczne zmiany gęstości energii wzdłuż głównej linii echa Fig.~\ref{fig:stft}. Na TF plane znacznie łatwiej zobaczyć kształt przebieg modulacji częstotliwości związanego z oddychaniem.

Fig.~\ref{fig:sstft} przedstawia skoncentrowany spektrogram z wykorzystaniem first-order vertical synchrosqueezing. Prawie cała energia sygnału została skupiona przy głównej linii echa, co ułatwi dalszą dekompozycję na składowe.

Fig.~\ref{fig:heartbeat_sstft} which shows the synchrosqueezed TF plane with the respiratory component cut out by using a mask following the detected TF ridge.

Fig.~\ref{breath_signal} i Fig.~\ref{hb_signal} przedstawiają zrekonstruowany sygnał z zużyciem odwrotnej transformacji w sytuacji, gdy zastosowana maska jest odpowiednio nieodwrócona i odwrócona. Pierwszy przypadek odpowiada komponentowi oddechowemu, natomiast drugi to echo związane z pracą serca. W ostatnim przypadku widać wyraźnie powtarzające się wysokoczęstotliwościowe oscylacje, które odpowiadają cyklom pracy serca.

Warto zauważyć, że echo związane z praca serca jest tak słabe w porównaniu do oddechu, że prawie nie widać różnicy między sygnałem surowym a filtrowanym (por. Fig.~\ref{fig:raw} i Fig.~\ref{breath_signal}).





- Wygenerować dla jednego pomiaru
- SSTFT1, SSTFT2, rekonstrukcja oddechu i tętna, surowy sygnał, maska, tfridges, pspectrum, rms
- nie podawać tytułów wykresów, tylko opisy osi


- breath1
- breath3

stft window: 
parametry: rms window: 0.2 s
ridge vicinity two-side width to generate binary mask 15.125 Hz (15 sampli w jedną stronę)
Carrier frequency: 121.16 GHz
Bandwidth: 5 GHz
Sample frequency of demodulated signal: 1 MHz





internal parameters:
decimation = 20
fs = 5000/decimation = 250

sigma = 12;         % szerokosc okna (tyle sampli jest równa sigma rozkładu Gaussa), FWHM = 28.2613 sampli, czyli 0.1130 [s]
gamma_K = 1e-4;     % prog przyciecia nieskonczonego okna Gaussa
N_FFT = 512;       % ilosc punktow na osi czestotliwoscisigna
signal_size = 2505
rec len = 10 s
vertical sstft rank = {1,2}

 
section{Conclusion}




- Bezdotykowy pomiar parametrów życiowych przy użyciu radaru w ostatnim czasie zyskuje coraz większą popularność i jest szeroko badany.

- Metody czasowo-częstotliwościowe pozwalają na pełniejszą wizualizację i dekompozycję sygnału na składowe. Jednakże jednym z ograniczeń jest znaczne rozmycie energii po płaszczyźnie czas-częstotliwość, szczególnie w przypadku STFT. Można sztucznie zwiększyć rozdzielczość stosując metody koncentracji spektrogramu, takie jak synchrosqueezing czy reassignment. Metody te w odniesieniu do radarowych nagrań aktywności życiowych są głównym przedmiotem badań niniejszej pracy.


W niektórych przypadkach estymacja chwilowej częstotliwości sygnału jest ja




Eksperymentalne nagrania radarowe zostały uzyskane przy użyciu systemu XY-DemoRad pracującego na częstotliwości 122 GHz. Antena skierowana prosto 



INTRODUCTION






%%%%%%%%%%%%%%%

INTRODUCTION - 


////////////////////////////
PROCESSING


 





Conclusion


Podsumowując, synchrosqueezing jest skuteczną metodą dekompozycji radar vital signs signals. Udało się zrekonstruować heartbeat-related echo signal i dokonać estymacji tętna.
The advantage of time-frequency analysis over phase demodulation is that it is a natural way to represent a signal consisting of many components, which allows for easy decomposition. This is particularly important in radar applications, where many independent signals may be observed simultaneously. In addition, the time-frequency representation contains information about the energy distribution of the signal, while the phase waveform alone may often be not reliable enough. TF-plane can also be used as input to efficient image processing algorithms based on neural networks.


 
 
 


